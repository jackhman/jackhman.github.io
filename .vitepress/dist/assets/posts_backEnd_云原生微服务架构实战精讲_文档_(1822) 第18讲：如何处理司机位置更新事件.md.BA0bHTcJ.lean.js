import{_ as h,F as l,g as k,K as n,h as i,l as s,ar as t,o as p}from"./chunks/framework.VlluEs-f.js";const P=JSON.parse('{"title":"第18讲：如何处理司机位置更新事件","description":"","frontmatter":{},"headers":[],"relativePath":"posts/backEnd/云原生微服务架构实战精讲_文档/(1822) 第18讲：如何处理司机位置更新事件.md","filePath":"posts/backEnd/云原生微服务架构实战精讲_文档/(1822) 第18讲：如何处理司机位置更新事件.md","lastUpdated":1718371218000}'),e={name:"posts/backEnd/云原生微服务架构实战精讲_文档/(1822) 第18讲：如何处理司机位置更新事件.md"},E=s("h1",{id:"第18讲-如何处理司机位置更新事件",tabindex:"-1"},[i("第18讲：如何处理司机位置更新事件 "),s("a",{class:"header-anchor",href:"#第18讲-如何处理司机位置更新事件","aria-label":'Permalink to "第18讲：如何处理司机位置更新事件"'},"​")],-1),r=s("p",null,"在第 17 课时中，我介绍了事件源技术的基本概念，并提供了基本的 Java 实现。在实际的开发中，我们通常使用已有的开源框架来实现事件源，不同的编程语言和平台都有事件源的开源实现。下表给出了几个比较流行的开源实现，示例应用使用的是 Axon。",-1),d=s("p",null,"示例应用中使用事件源技术的场景是司机位置的更新。本课时将介绍如何使用 Axon 来更新司机的位置，除了本课时之外，在介绍 CQRS 技术的课时中，也会用到 Axon。",-1),g=s("p",null,"在打车应用中，司机需要实时更新其当前位置。司机的位置信息是派发行程的重要依据，同时也是很多安全相关的功能的基础，打车应用的司机 App 会定期读取 GPS 中的位置信息，并发送给服务器。这属于典型的事件应用的场景。示例应用中虽然没有司机 App，但是有司机模拟器来模拟司机的行为，也会同样发送被模拟的司机位置信息给服务器。",-1),o=s("h3",{id:"axon",tabindex:"-1"},[i("Axon "),s("a",{class:"header-anchor",href:"#axon","aria-label":'Permalink to "Axon"'},"​")],-1),y=s("p",null,"Axon 是一个事件驱动的微服务的完整解决方案，我们可以完全基于 Axon 来开发事件驱动的微服务架构的应用。Axon 包括 Axon 框架和 Axon 服务器两个部分。Axon 框架是 Axon 中的编程模型，提供了 SDK 来构建应用，支持事件源和 CQRS 等技术；Axon 服务器则是一个高可用性和可伸缩的事件存储。Axon 框架并不一定要使用 Axon 服务器作为事件存储，也可以使用关系型数据库、MongoDB 或内存作为事件存储方式。不过 Axon 服务器提供了额外的功能，适合于生产环境。",-1),c=s("p",null,"Axon 支持 3 种不同类型的消息，这 3 种消息模式，可以适用于不同的应用场景，如下表所示。",-1),F=t("",13),A=s("p",null,"下图是司机模拟器的界面，上面展示了每个司机的状态，以及可以进行的操作。",-1),v=t("",9),D=s("h3",{id:"处理事件",tabindex:"-1"},[i("处理事件 "),s("a",{class:"header-anchor",href:"#处理事件","aria-label":'Permalink to "处理事件"'},"​")],-1),C=s("p",null,"事件的处理器通过在处理方法上添加 @EventHandler 注解来声明。事件处理方法的第一个参数是事件消息的载荷类型，这个载荷类型用来确定可以被处理的事件类型。一个事件处理类中可以包含多个方法来处理不同类型的事件，对于一个事件处理对象，最多只有一个处理方法被调用。如果有多个方法可以匹配，那么参数类型最具体的那个方法会被调用；如果处理方法不需要访问事件的载荷对象，则可以通过 @EventHandler 注解的 payloadType 属性来声明载荷对象的类型，而不需要添加额外的方法参数。",-1),u=s("p",null,"除了事件的载荷之外，处理方法还可以声明其他类型的参数来自动获取事件对象中的其他值，如下表所示。",-1),B=t("",8);function _(b,x,m,f,S,L){const a=l("Image");return p(),k("div",null,[E,r,n(a,{alt:"图片1.png",src:"https://s0.lgstatic.com/i/image/M00/0A/91/Ciqc1F6-O7-AbNaEAABsUgyb3p4652.png"}),i(),d,g,o,y,c,n(a,{alt:"图片2.png",src:"https://s0.lgstatic.com/i/image/M00/0A/91/Ciqc1F6-O9iAaudNAABwa1Xbpcs676.png"}),i(),F,n(a,{alt:"图片3.png",src:"https://s0.lgstatic.com/i/image/M00/0A/92/CgqCHl6-PDOAYpzBAACdUJiQWy8457.png"}),i(),A,n(a,{alt:"1.png",src:"https://s0.lgstatic.com/i/image/M00/0A/92/CgqCHl6-PGaAIeH2AACO1T8V_bc838.png"}),i(),v,n(a,{alt:"2.png",src:"https://s0.lgstatic.com/i/image/M00/0A/92/CgqCHl6-PKCAUPryAAGWDuo36aQ691.png"}),i(),D,C,u,n(a,{alt:"图片4.png",src:"https://s0.lgstatic.com/i/image/M00/0A/92/Ciqc1F6-PLyAESmaAAC8VF4QX40040.png"}),i(),B])}const R=h(e,[["render",_]]);export{P as __pageData,R as default};
