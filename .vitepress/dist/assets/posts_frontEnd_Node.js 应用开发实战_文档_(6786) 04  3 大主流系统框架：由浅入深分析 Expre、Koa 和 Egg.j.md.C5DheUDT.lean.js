import{_ as h,F as l,g as k,K as n,h as i,ar as p,l as s,o as t}from"./chunks/framework.VlluEs-f.js";const N=JSON.parse('{"title":"043大主流系统框架：由浅入深分析Expre、Koa和Egg.j","description":"","frontmatter":{},"headers":[],"relativePath":"posts/frontEnd/Node.js 应用开发实战_文档/(6786) 04  3 大主流系统框架：由浅入深分析 Expre、Koa 和 Egg.j.md","filePath":"posts/frontEnd/Node.js 应用开发实战_文档/(6786) 04  3 大主流系统框架：由浅入深分析 Expre、Koa 和 Egg.j.md","lastUpdated":1718371218000}'),e={name:"posts/frontEnd/Node.js 应用开发实战_文档/(6786) 04  3 大主流系统框架：由浅入深分析 Expre、Koa 和 Egg.j.md"},E=p("",7),r=p("",8),d=p("",46),g=p("",19),y=s("p",null,"图 3 Express app.use 代码实现",-1),o=s("p",null,[i("当没有传入 path 时，会默认设置 path 为 / ，而 / 则是"),s("strong",null,"匹配任何路径"),i("，最终都是调用 router.use 将 fn 中间件函数传入到 router 中。")],-1),F=s("p",null,"接下来我们看下 router.use 的代码实现。",-1),c=s("p",null,[s("strong",null,"router/index.js")],-1),C=s("p",null,"这个文件在当前目录 router 下的 index.js 中，有一个方法叫作 proto.use，即 application.js 中调用的 router.use 。",-1),A=s("p",null,"图 4 中间件 push 实现",-1),u=s("p",null,"图 4 中的代码经过一系列处理，最终将中间件函数通过 Layer 封装后放到栈列表中。就完成了中间件的处理，最后我们再来看下用户请求时，是如何在栈列表执行的。",-1),B=s("p",null,[i("所有请求进来后都会调用 application.js 中的 "),s("strong",null,"app.handle"),i(" 方法，该方法最终调用的是 router/index.js 中的 "),s("strong",null,"proto.handle"),i(" 方法，所以我们主要看下 router.handle 的实现。在这个函数中有一个 next 方法非常关键，用于判断执行"),s("strong",null,"下一层中间件的逻辑"),i("，它的原理是从栈列表中取出一个 layer 对象，判断是否满足当前匹配，如果满足则执行该中间件函数，如图 5 所示。")],-1),v=s("p",null,"图 5 中间件执行逻辑",-1),D=s("p",null,"接下来我们再看看 layer.handle_request 的代码逻辑，如图 6 所示。",-1),b=p("",21),m=s("p",null,[i("]("),s("a",{href:"https://shenceyun.lagou.com/t/mka",target:"_blank",rel:"noreferrer"},"https://shenceyun.lagou.com/t/mka"),i(")")],-1),x=s("p",null,[s("strong",null,"《大前端高薪训练营》")],-1),_=s("p",null,[i("对标阿里 P7 技术需求 + 每月大厂内推，6 个月助你斩获名企高薪 Offer。"),s("a",{href:"https://shenceyun.lagou.com/t/mka",target:"_blank",rel:"noreferrer"},"点击链接"),i("，快来领取！")],-1);function j(f,w,K,O,T,P){const a=l("Image");return t(),k("div",null,[E,n(a,{alt:"Drawing 0.png",src:"https://s0.lgstatic.com/i/image6/M00/17/0C/CioPOWBHM5qAFpsgAA9oKfFNTFM895.png"}),i(),r,n(a,{alt:"Drawing 1.png",src:"https://s0.lgstatic.com/i/image6/M00/17/10/Cgp9HWBHM6eAF1p7AAG-YifWNQg212.png"}),i(),d,n(a,{alt:"Drawing 2.png",src:"https://s0.lgstatic.com/i/image6/M01/17/0D/CioPOWBHM7-AN7gmAABaG7HpWG8493.png"}),i(),g,n(a,{alt:"Drawing 3.png",src:"https://s0.lgstatic.com/i/image6/M01/17/10/Cgp9HWBHM-CAYcukAAFHHQytNag202.png"}),i(),y,o,F,c,C,n(a,{alt:"Drawing 4.png",src:"https://s0.lgstatic.com/i/image6/M01/17/0D/CioPOWBHM-eAT835AAFGYW1HaL0653.png"}),i(),A,u,B,n(a,{alt:"Drawing 5.png",src:"https://s0.lgstatic.com/i/image6/M01/17/0D/CioPOWBHM_CAGrfhAAEAXbjYjVU402.png"}),i(),v,D,n(a,{alt:"Drawing 6.png",src:"https://s0.lgstatic.com/i/image6/M01/17/10/Cgp9HWBHM_iAAdIdAACdFAXr7Tg707.png"}),i(),b,n(a,{alt:"Drawing 2.png",src:"https://s0.lgstatic.com/i/image6/M00/12/FA/CioPOWBBrAKAAod-AASyC72ZqWw233.png"}),i(),m,x,_])}const S=h(e,[["render",j]]);export{N as __pageData,S as default};
