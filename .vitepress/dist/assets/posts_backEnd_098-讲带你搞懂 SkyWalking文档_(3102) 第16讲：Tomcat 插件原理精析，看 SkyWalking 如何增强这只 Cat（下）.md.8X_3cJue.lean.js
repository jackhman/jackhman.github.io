import{_ as e,F as p,g as h,K as i,h as a,ar as t,l as n,o as l}from"./chunks/framework.VlluEs-f.js";const q=JSON.parse('{"title":"第16讲：Tomcat插件原理精析，看SkyWalking如何增强这只Cat（下）","description":"","frontmatter":{},"headers":[],"relativePath":"posts/backEnd/098-讲带你搞懂 SkyWalking文档/(3102) 第16讲：Tomcat 插件原理精析，看 SkyWalking 如何增强这只 Cat（下）.md","filePath":"posts/backEnd/098-讲带你搞懂 SkyWalking文档/(3102) 第16讲：Tomcat 插件原理精析，看 SkyWalking 如何增强这只 Cat（下）.md","lastUpdated":1718371218000}'),k={name:"posts/backEnd/098-讲带你搞懂 SkyWalking文档/(3102) 第16讲：Tomcat 插件原理精析，看 SkyWalking 如何增强这只 Cat（下）.md"},r=t("",12),E=n("p",null,"此时请求没有与任何 Trace 关联，也就不会携带 ContextCarrier 请求头，beforeMethod() 方法中会创建全新的 TracingContext 以及 EntrySpan。",-1),d=n("ol",{start:"2"},[n("li",null,"tomcat-7.x-8.x-plugin 插件被嵌套在其他插件之后的场景，如下图所示：")],-1),g=n("p",null,"此时请求在经过其他插件的时候，已经创建了关联的 TracingContext 以及 EntrySpan，beforeMethod() 方法无需创建 TracingContext，只需重新调用 EntrySpan 的 start() 方法即可。",-1),o=n("ol",{start:"3"},[n("li",null,"Tomcat 作为下游系统被其他系统调用的场景，如下图所示：")],-1),c=t("",6),y=n("p",null,"先来看序列化过程，ContextCarrier.items() 方法会根据 ACTIVE_V2_HEADER 配置以及 ACTIVE_V1_HEADER 配置决定当前 Agent 支持哪个版本的格式（也可以同时支持），下图展示了在同时支持 V1、V2 两个版本序列化格式时，ContextCarrier.items() 方法创建的 CarrierItem 链表：",-1),C=t("",16),F=t("",4),A=t("",5),u=t("",4),m=n("p",null,"当请求经过所有的 Pipeline-Valve 的处理之后，Tomcat 会将返回的结果交给 Connector，Connector 会通过底层的 Socket 连接将响应结果返回给用户。",-1),D=n("p",null,"理清 Tomcat 架构之后，本课时的第 2 部分深入介绍了 tomcat-7.x-8.x-plugin 插件对 StandardHostValve 中 invoke() 方法的增强，同时还深入讲解了 ContextCarrier 同时支持多个序列化版本的实现原理。最后介绍了 forward 跳转、redirect 跳转的原理，以及 tomcat-7.x-8.x-plugin 插件对 forward 跳转的处理。",-1);function _(v,T,S,x,b,B){const s=p("Image");return l(),h("div",null,[r,i(s,{alt:"1.png",src:"https://s0.lgstatic.com/i/image/M00/00/AF/CgqCHl6qTfmAEU6RAAC170V3ef8022.png"}),a(),E,d,i(s,{alt:"2.png",src:"https://s0.lgstatic.com/i/image/M00/00/AF/CgqCHl6qTheAD0FbAADiLfWhOis706.png"}),a(),g,o,i(s,{alt:"3.png",src:"https://s0.lgstatic.com/i/image/M00/00/AF/CgqCHl6qTi-AFnZOAADQxYkP_ok501.png"}),a(),c,i(s,{alt:"4.png",src:"https://s0.lgstatic.com/i/image/M00/00/BB/CgqCHl6qZFmASH0MAABQy3R7qxw376.png"}),a(),y,i(s,{alt:"image (3).png",src:"https://s0.lgstatic.com/i/image/M00/00/BB/Ciqc1F6qZHCAW4yoAAFesp2L980140.png"}),a(),C,i(s,{alt:"image (4).png",src:"https://s0.lgstatic.com/i/image/M00/00/BB/CgqCHl6qZNuANBrFAAHuLLyTujQ360.png"}),a(),F,i(s,{alt:"image (5).png",src:"https://s0.lgstatic.com/i/image/M00/00/BC/CgqCHl6qZcmAJZYZAAGM2VAIvQ8947.png"}),a(),A,i(s,{alt:"image (6).png",src:"https://s0.lgstatic.com/i/image/M00/00/BC/CgqCHl6qZkKAB_A5AABVHOMz99A638.png"}),a(),u,i(s,{alt:"image (7).png",src:"https://s0.lgstatic.com/i/image/M00/00/BC/CgqCHl6qZmuASJgqAAHvghToaYo778.png"}),a(),m,D])}const H=e(k,[["render",_]]);export{q as __pageData,H as default};
