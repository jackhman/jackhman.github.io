import{_ as h,F as e,g as n,K as t,h as i,l as s,ar as p,o as l}from"./chunks/framework.VlluEs-f.js";const ss=JSON.parse('{"title":"16逻辑漏洞：你的订单信息是如何泄露的？","description":"","frontmatter":{},"headers":[],"relativePath":"posts/devops/Web 安全攻防之道_文档/(5984) 16  逻辑漏洞：你的订单信息是如何泄露的？.md","filePath":"posts/devops/Web 安全攻防之道_文档/(5984) 16  逻辑漏洞：你的订单信息是如何泄露的？.md","lastUpdated":1718371218000}'),k={name:"posts/devops/Web 安全攻防之道_文档/(5984) 16  逻辑漏洞：你的订单信息是如何泄露的？.md"},r=s("h1",{id:"_16逻辑漏洞-你的订单信息是如何泄露的",tabindex:"-1"},[i("16逻辑漏洞：你的订单信息是如何泄露的？ "),s("a",{class:"header-anchor",href:"#_16逻辑漏洞-你的订单信息是如何泄露的","aria-label":'Permalink to "16逻辑漏洞：你的订单信息是如何泄露的？"'},"​")],-1),o=s("p",null,"本节课开始介绍越权漏洞，这是一种偏业务逻辑处理缺陷的漏洞，不仅是 Web 应用，许多应用场景中会可能会遇到。",-1),d=s("p",null,'比如去年 12 月底，因北京健康宝网站存在越权漏洞，导致了"明星健康宝照片泄露"事件，大量用户的个人信息被窃取，其中不乏明星的姓名、身份证、素颜照等个人隐私信息。',-1),g=p("",9),c=s("p",null,"图 2 水平越权题目",-1),_=s("p",null,'先用 lucy 的账号密码登录，点击"点击查看个人信息"，页面返回 lucy 的个人信息：',-1),E=p("",6),A=p("",7),u=s("p",null,"图 5 Pikachu 靶场垂直越权题目",-1),y=s("p",null,"分别登录这 2 个账号看下有啥区别，下图是 admin 登录后返回的信息，可以看它拥有添加和删除用户的权限：",-1),m=p("",5),D=p("",4),C=p("",5),F=p("",4),b=p("",7),v=s("p",null,"图 11 Manual install",-1),S=s("p",null,"下面介绍的这些工具都是刷漏洞奖励平台的利器，而且越权漏洞跟别人撞洞的概率也会相对低些，有些奖金也不低。",-1),T=s("h4",{id:"_1-authz",tabindex:"-1"},[i("1.Authz "),s("a",{class:"header-anchor",href:"#_1-authz","aria-label":'Permalink to "1.Authz"'},"​")],-1),B=s("p",null,"Authz 的使用比较简单，在 BurpSuite 中将需要测试的请求发送到 Authz：",-1),P=s("p",null,"图 12 发送请求到 Authz",-1),q=s("p",null,'之后修改 Cookie 值为其他用户，也可以是其他请求头信息，待准备测试的请求收集完后，点击"Run"按钮即可。如果原响应内容长度、状态码和被修改请求后的响应内容长度、状态码一致，则会被标为绿色，表示可能存在越权漏洞。',-1),f=s("p",null,"图 13 Authz",-1),I=s("p",null,'以普通用户 pikachu 直接访问绿色的 URL，可以直接打开"添加用户"的界面进行操作，这原来是管理员 admin 才拥有的权限，非常明显的越权行为。',-1),w=s("p",null,'图 14 普通用户越权访问"添加用户"管理页面',-1),V=s("h4",{id:"_2-autorize",tabindex:"-1"},[i("2.Autorize "),s("a",{class:"header-anchor",href:"#_2-autorize","aria-label":'Permalink to "2.Autorize"'},"​")],-1),x=s("p",null,"Autorize 会对客户端发送的所有请求数据进行修改后重放，主要是将其他用户的 Cookie 替换当前用户的 Cookie，或者其他授权验证相关的请求头。",-1),M=s("p",null,"Autorize 不用像 Authz 那样挑选请求并发送到插件，它可以直接配置要替换的头信息，包括 Cookie 或者其他验证头信息，同时支持作用域过滤器，用来筛选我们感兴趣的请求，避免收到大量的无用结果。",-1),R=s("p",null,"图 15 将其他用户的 Cookie 配置到 Autorize 进行替换",-1),j=s("p",null,"之后也是通过对比修改前后的响应结果来判断越权漏洞是否存在，若响应长度和状态码一样，那就有可能存在越权漏洞。不过，有时候也需要人工难证下，有可能一些页面本身就是允许任意用户访问的，需要分析下原设定的正常业务逻辑。",-1),z=s("h4",{id:"_3-auto-repeater",tabindex:"-1"},[i("3.Auto Repeater "),s("a",{class:"header-anchor",href:"#_3-auto-repeater","aria-label":'Permalink to "3.Auto Repeater"'},"​")],-1),Y=s("p",null,"像 Authz 这种挑选请求并发送到插件的方式，测试效率会低一些，没有 Auto Repeater 高效。",-1),N=s("p",null,"Auto Repeater 功能相对 Autorize 更多更复杂一些，可以理解为是它的扩展版，是基于自动请求重放与响应比对的方式进行检测的，它可以对更加具体的请求参数进行测试，比如 PHPSESSID、SID、UID 等涉及用户身份的参数，支持正则匹配与替换。",-1),G=s("p",null,'点击"Active AutoRepeater"开启，再添加替换规则。比如，我想替换 Cookie 中的 PHPSESSID 参数值，可以在 Replacements 中添加替换规则，然后在 Base Replacements 下为 cookie 配置一个规则，Type 选择"Match Cookie Name, Replace Value"Match 设置为 Cookie 名称 PHPSESSID，替换为权限较低的用户的 Cookie 值。',-1),H=s("p",null,"图 16 设置替换规则",-1),O=s("p",null,"在之后的捕获的请求中，若满足匹配条件就会自动修改数据并重新发送请求，用户再根据响应结果是否有差异来判断是否存在越权漏洞，可以通过 Logs 设置颜色标记来区分，避免请求过多时，浪费过多时间排查验证。",-1),W=p("",9);function U(J,L,Q,$,X,Z){const a=e("Image");return l(),n("div",null,[r,o,d,t(a,{alt:"Drawing 0.png",src:"https://s0.lgstatic.com/i/image/M00/92/A6/Ciqc1GASYk-ASivfAAPyqJojcO8233.png"}),i(),g,t(a,{alt:"Drawing 1.png",src:"https://s0.lgstatic.com/i/image/M00/92/B2/CgqCHmASYl-ALlPQAADSntiMgeU273.png"}),i(),c,_,t(a,{alt:"Drawing 2.png",src:"https://s0.lgstatic.com/i/image/M00/92/A7/Ciqc1GASYmWAedkmAABNDwsDWvI235.png"}),i(),E,t(a,{alt:"Drawing 3.png",src:"https://s0.lgstatic.com/i/image/M00/92/B2/CgqCHmASYm2Ab2EyAABOWImk5eg862.png"}),i(),A,t(a,{alt:"Drawing 4.png",src:"https://s0.lgstatic.com/i/image/M00/92/B2/CgqCHmASYneAdXuCAADff3i9-q4853.png"}),i(),u,y,t(a,{alt:"图片6.png",src:"https://s0.lgstatic.com/i/image6/M00/01/31/CioPOWAbYS6AYutqAAEgV7cor_U446.png"}),i(),m,t(a,{alt:"Drawing 6.png",src:"https://s0.lgstatic.com/i/image/M00/92/B2/CgqCHmASYoWAMqv3AABGLZP_sT8238.png"}),i(),D,t(a,{alt:"Drawing 7.png",src:"https://s0.lgstatic.com/i/image/M00/92/A7/Ciqc1GASYo2AdHCIAACXy3twnlg665.png"}),i(),C,t(a,{alt:"Drawing 8.png",src:"https://s0.lgstatic.com/i/image2/M01/0A/9B/Cip5yGASYpmAeunBAAFp0VO-lcU355.png"}),i(),F,t(a,{alt:"Drawing 9.png",src:"https://s0.lgstatic.com/i/image2/M01/0A/9B/Cip5yGASYqSAFf6HAAGb6JILlBg819.png"}),i(),b,t(a,{alt:"Drawing 10.png",src:"https://s0.lgstatic.com/i/image2/M01/0A/9D/CgpVE2ASYrCAQc0UAAFN0G_SETY095.png"}),i(),v,S,T,B,t(a,{alt:"Drawing 11.png",src:"https://s0.lgstatic.com/i/image2/M01/0A/9B/Cip5yGASYrmAJhs1AACr4L3wFK8509.png"}),i(),P,q,t(a,{alt:"Drawing 12.png",src:"https://s0.lgstatic.com/i/image2/M01/0A/9B/Cip5yGASYsSAf32BAAFo4WeYkHI407.png"}),i(),f,I,t(a,{alt:"Drawing 13.png",src:"https://s0.lgstatic.com/i/image2/M01/0A/9D/CgpVE2ASYs6AJzZgAAB88FDAhz8507.png"}),i(),w,V,x,M,t(a,{alt:"图片15.png",src:"https://s0.lgstatic.com/i/image6/M00/01/33/Cgp9HWAbYU-AUaN3AAJjCrZ0Gu0927.png"}),i(),R,j,z,Y,N,G,t(a,{alt:"Drawing 15.png",src:"https://s0.lgstatic.com/i/image2/M01/0A/9B/Cip5yGASYt-AJi6UAACfduv_yr0494.png"}),i(),H,O,t(a,{alt:"Drawing 16.png",src:"https://s0.lgstatic.com/i/image2/M01/0A/9B/Cip5yGASYuiAAHGlAAEQwQoXtvw776.png"}),i(),W])}const is=h(k,[["render",U]]);export{ss as __pageData,is as default};
