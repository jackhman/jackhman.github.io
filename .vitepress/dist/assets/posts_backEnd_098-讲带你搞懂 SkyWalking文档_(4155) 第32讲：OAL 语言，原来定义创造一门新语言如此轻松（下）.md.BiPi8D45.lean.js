import{_ as l,F as h,g as p,K as n,h as i,l as s,ar as t,o as k}from"./chunks/framework.VlluEs-f.js";const b=JSON.parse('{"title":"第32讲：OAL语言，原来定义创造一门新语言如此轻松（下）","description":"","frontmatter":{},"headers":[],"relativePath":"posts/backEnd/098-讲带你搞懂 SkyWalking文档/(4155) 第32讲：OAL 语言，原来定义创造一门新语言如此轻松（下）.md","filePath":"posts/backEnd/098-讲带你搞懂 SkyWalking文档/(4155) 第32讲：OAL 语言，原来定义创造一门新语言如此轻松（下）.md","lastUpdated":1718371218000}'),e={name:"posts/backEnd/098-讲带你搞懂 SkyWalking文档/(4155) 第32讲：OAL 语言，原来定义创造一门新语言如此轻松（下）.md"},r=s("h1",{id:"第32讲-oal语言-原来定义创造一门新语言如此轻松-下",tabindex:"-1"},[i("第32讲：OAL语言，原来定义创造一门新语言如此轻松（下） "),s("a",{class:"header-anchor",href:"#第32讲-oal语言-原来定义创造一门新语言如此轻松-下","aria-label":'Permalink to "第32讲：OAL语言，原来定义创造一门新语言如此轻松（下）"'},"​")],-1),E=s("p",null,"了解了 OAL 语言的基础语法以及 official_analysis.oal 文件中典型的 OAL 语句之后，我们来看 official_analysis.oal 文件是如何被解析的。",-1),g=s("p",null,"在generate-tool-grammar 模块中会使 antlr4-maven-plugin 这个 Maven 插件处理 OALParser.g4 以及 OALLexer.g4 文件，得到相应的辅助类，如下图所示，这与前文 Antlr4 示例相同：",-1),d=t("",4),y=t("",10),c=s("p",null,"(11).exitAggregationStatement() 方法：这里使用 DeepAnalysis 分析前 10 步从 OAL 语句获取到的信息，从而完整填充整个 AnalysisResult 对象。",-1),o=s("ul",null,[s("li",null,"在 DeepAnalysis 中首先会根据 aggregationFunctionName 确定当前指标的类型并填充 metricsClassName 字段。示例中的 longAvg 会查找到 LongAvgMetrics 类，如下图所示：")],-1),F=t("",7),A=s("ul",null,[s("li",null,[s("p",null,"扫描 LongAvgMetrics 中的全部字段，将所有 @Column 注解标注的字段封装成 DataColumn 对象记录到 persistentFields 集合中。")]),s("li",null,[s("p",null,"根据 sourceName 字段的值从 generator-scope-meta.yml 文件中查找该 source 默认新增的字段，如下图所示，InstanceJvmOldGcTimeMetrics 需要新增 entityId、serviceId 两个字段，这也与我们之前的分析相同。这些新增字段会记录到 fieldsFromSource 集合中。")])],-1),D=t("",10),u=t("",13);function m(C,_,v,B,S,M){const a=h("Image");return k(),p("div",null,[r,E,g,n(a,{alt:"Drawing 0.png",src:"https://s0.lgstatic.com/i/image/M00/2E/1A/CgqCHl8ETYeADqgoAAE8NIoy0_c302.png"}),i(),d,n(a,{alt:"Drawing 1.png",src:"https://s0.lgstatic.com/i/image/M00/2E/0E/Ciqc1F8ETZ2APvsSAAMOZtTc1cI758.png"}),i(),y,n(a,{alt:"Drawing 2.png",src:"https://s0.lgstatic.com/i/image/M00/2E/0E/Ciqc1F8ETaeAbBI9AAK4QkZfEcY292.png"}),i(),c,o,n(a,{alt:"Drawing 3.png",src:"https://s0.lgstatic.com/i/image/M00/2E/1A/CgqCHl8ETbGAKMAIAAEGRmp6VX8630.png"}),i(),F,n(a,{alt:"Drawing 4.png",src:"https://s0.lgstatic.com/i/image/M00/2E/0E/Ciqc1F8ETcGAFSJfAAD90Ejj-vM209.png"}),i(),A,n(a,{alt:"Drawing 5.png",src:"https://s0.lgstatic.com/i/image/M00/2E/1A/CgqCHl8ETciAVpVKAAEuRAJmdIU888.png"}),i(),D,n(a,{alt:"Drawing 6.png",src:"https://s0.lgstatic.com/i/image/M00/2E/0E/Ciqc1F8ETfCABEkKAAEpESqaVTE235.png"}),i(),u])}const T=l(e,[["render",m]]);export{b as __pageData,T as default};
